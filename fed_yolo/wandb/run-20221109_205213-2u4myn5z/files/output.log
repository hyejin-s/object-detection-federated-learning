
weights: /hdd/hdd3/coco_fl/best.pt
                 from  n    params  module                                  arguments
                 from  n    params  module                                  arguments
  0                -1  1      3520  models.common.Conv                      [3, 32, 6, 2, 2]
  0                -1  1      3520  models.common.Conv                      [3, 32, 6, 2, 2]
  1                -1  1     18560  models.common.Conv                      [32, 64, 3, 2]
  1                -1  1     18560  models.common.Conv                      [32, 64, 3, 2]
  2                -1  1     18816  models.common.C3                        [64, 64, 1]
  2                -1  1     18816  models.common.C3                        [64, 64, 1]
  3                -1  1     73984  models.common.Conv                      [64, 128, 3, 2]
  3                -1  1     73984  models.common.Conv                      [64, 128, 3, 2]
  4                -1  2    115712  models.common.C3                        [128, 128, 2]
  4                -1  2    115712  models.common.C3                        [128, 128, 2]
  5                -1  1    295424  models.common.Conv                      [128, 256, 3, 2]
  5                -1  1    295424  models.common.Conv                      [128, 256, 3, 2]
  6                -1  3    625152  models.common.C3                        [256, 256, 3]
  6                -1  3    625152  models.common.C3                        [256, 256, 3]
  7                -1  1   1180672  models.common.Conv                      [256, 512, 3, 2]
  7                -1  1   1180672  models.common.Conv                      [256, 512, 3, 2]
  8                -1  1   1182720  models.common.C3                        [512, 512, 1]
  8                -1  1   1182720  models.common.C3                        [512, 512, 1]
  9                -1  1    656896  models.common.SPPF                      [512, 512, 5]
  9                -1  1    656896  models.common.SPPF                      [512, 512, 5]
 10                -1  1    131584  models.common.Conv                      [512, 256, 1, 1]
 10                -1  1    131584  models.common.Conv                      [512, 256, 1, 1]
 11                -1  1         0  torch.nn.modules.upsampling.Upsample    [None, 2, 'nearest']
 11                -1  1         0  torch.nn.modules.upsampling.Upsample    [None, 2, 'nearest']
 12           [-1, 6]  1         0  models.common.Concat                    [1]
 12           [-1, 6]  1         0  models.common.Concat                    [1]
 13                -1  1    361984  models.common.C3                        [512, 256, 1, False]
 13                -1  1    361984  models.common.C3                        [512, 256, 1, False]
 14                -1  1     33024  models.common.Conv                      [256, 128, 1, 1]
 14                -1  1     33024  models.common.Conv                      [256, 128, 1, 1]
 15                -1  1         0  torch.nn.modules.upsampling.Upsample    [None, 2, 'nearest']
 15                -1  1         0  torch.nn.modules.upsampling.Upsample    [None, 2, 'nearest']
 16           [-1, 4]  1         0  models.common.Concat                    [1]
 16           [-1, 4]  1         0  models.common.Concat                    [1]
 17                -1  1     90880  models.common.C3                        [256, 128, 1, False]
 17                -1  1     90880  models.common.C3                        [256, 128, 1, False]
 18                -1  1    147712  models.common.Conv                      [128, 128, 3, 2]
 18                -1  1    147712  models.common.Conv                      [128, 128, 3, 2]
 19          [-1, 14]  1         0  models.common.Concat                    [1]
 19          [-1, 14]  1         0  models.common.Concat                    [1]
 20                -1  1    296448  models.common.C3                        [256, 256, 1, False]
 20                -1  1    296448  models.common.C3                        [256, 256, 1, False]
 21                -1  1    590336  models.common.Conv                      [256, 256, 3, 2]
 21                -1  1    590336  models.common.Conv                      [256, 256, 3, 2]
 22          [-1, 10]  1         0  models.common.Concat                    [1]
 22          [-1, 10]  1         0  models.common.Concat                    [1]
 23                -1  1   1182720  models.common.C3                        [512, 512, 1, False]
 23                -1  1   1182720  models.common.C3                        [512, 512, 1, False]
 24      [17, 20, 23]  1    229245  fedmodels.yolov5.models.yolo.Detect     [80, [[10, 13, 16, 30, 33, 23], [30, 61, 62, 45, 59, 119], [116, 90, 156, 198, 373, 326]], [128, 256, 512]]
 24      [17, 20, 23]  1    229245  fedmodels.yolov5.models.yolo.Detect     [80, [[10, 13, 16, 30, 33, 23], [30, 61, 62, 45, 59, 119], [116, 90, 156, 198, 373, 326]], [128, 256, 512]]
SGD
================ FL train with total model parameters: 7.2M  ================
++++++++++++++++ Other Train related parameters ++++++++++++++++
               batch_size: 32
                  central: 1
                  clients: [56, 60]
                data_conf: data/coco_custom.yaml
                  dataset: per_class
               decay_type: step
                    epoch: 50
                grad_clip: True
                 img_size: 640
            learning_rate: 1e-06
              local_epoch: 5
            max_grad_norm: 1.0
                 net_name: yolov5s
              num_workers: 8
           optimizer_type: SGD
                  project: FedYOLO
                 save_dir: ./exp/
                     seed: 42
       server_local_epoch: 5
                  shuffle: False
                step_size: 30
                    wandb: True
             warmup_steps: 100
             weight_decay: 0
                  weights: /hdd/hdd3/coco_fl/best.pt
                 yolo_cfg: fedmodels/yolov5/models/yolov5s.yaml
                 yolo_hyp: fedmodels/yolov5/data/hyps/hyp.scratch-low.yaml
++++++++++++++++  End of show parameters ++++++++++++++++
YOLOv5s summary: 214 layers, 7235389 parameters, 7235389 gradients, 16.6 GFLOPs
YOLOv5s summary: 214 layers, 7235389 parameters, 7235389 gradients, 16.6 GFLOPs
Transferred 348/349 items from /hdd/hdd3/coco_fl/best.pt
Transferred 348/349 items from /hdd/hdd3/coco_fl/best.pt
Scanning '/hdd/hdd3/coco/labels/val2017.cache' images and labels... 4952 found, 48 missing, 0 empty, 0 corrupt: 100%|██████████| 5000/5000 [00:00<?
Scanning '/hdd/hdd3/coco_fl/labels/node_1_class_56.cache' images and labels... 13148 found, 0 missing, 0 empty, 0 corrupt: 100%|██████████| 13148/1
Scanning '/hdd/hdd3/coco_fl/labels/node_2_class_60.cache' images and labels... 10161 found, 0 missing, 0 empty, 0 corrupt: 100%|██████████| 10161/1
Scanning '/hdd/hdd3/coco_fl/labels/server.cache' images and labels... 93957 found, 0 missing, 0 empty, 0 corrupt: 100%|██████████| 93957/93957 [00:
Scanning '/hdd/hdd3/coco/labels/val2017.cache' images and labels... 4952 found, 48 missing, 0 empty, 0 corrupt: 100%|██████████| 5000/5000 [00:00<?












                 Class     Images  Instances          P          R      mAP50   mAP50-95:  97%|█████████▋| 153/157 [00:25<00:00,  6.93it/s]
=============== start training ===============
---------- training server ----------
train the server of communication round 0
                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 157/157 [00:26<00:00,  5.97it/s]
                   all       5000      36335      0.568       0.38        0.4      0.226
                   all       5000      36335      0.568       0.38        0.4      0.226
[34m[1moptimizer:[39m[22m SGD(lr=1e-06) with parameter groups 57 weight(decay=0.0), 60 weight(decay=0.0005), 60 bias
[34m[1moptimizer:[39m[22m SGD(lr=1e-06) with parameter groups 57 weight(decay=0.0), 60 weight(decay=0.0005), 60 bias
[34m[1moptimizer:[39m[22m SGD(lr=1e-06) with parameter groups 57 weight(decay=0.0), 60 weight(decay=0.0005), 60 bias
[34m[1moptimizer:[39m[22m SGD(lr=1e-06) with parameter groups 57 weight(decay=0.0), 60 weight(decay=0.0005), 60 bias
[34m[1moptimizer:[39m[22m SGD(lr=1e-06) with parameter groups 57 weight(decay=0.0), 60 weight(decay=0.0005), 60 bias
[34m[1moptimizer:[39m[22m SGD(lr=1e-06) with parameter groups 57 weight(decay=0.0), 60 weight(decay=0.0005), 60 bias









  3%|▎         | 95/2937 [00:18<07:59,  5.93it/s]












  7%|▋         | 197/2937 [00:42<10:04,  4.53it/s]












 10%|█         | 296/2937 [01:06<13:53,  3.17it/s]













 14%|█▎        | 397/2937 [01:32<10:06,  4.19it/s]












 17%|█▋        | 496/2937 [01:56<10:56,  3.72it/s]














 20%|██        | 594/2937 [02:24<09:49,  3.98it/s]













 24%|██▎       | 697/2937 [02:50<09:38,  3.87it/s]














 27%|██▋       | 797/2937 [03:18<10:25,  3.42it/s]













 31%|███       | 897/2937 [03:44<06:05,  5.58it/s]














 34%|███▍      | 1000/2937 [04:12<10:12,  3.16it/s]














 38%|███▊      | 1103/2937 [04:40<07:42,  3.97it/s]














 41%|████      | 1198/2937 [05:09<11:23,  2.54it/s]















 44%|████▍     | 1302/2937 [05:39<07:27,  3.66it/s]














 48%|████▊     | 1398/2937 [06:07<12:08,  2.11it/s]














 51%|█████     | 1498/2937 [06:35<05:39,  4.24it/s]














 54%|█████▍    | 1598/2937 [07:03<06:25,  3.47it/s]

















 58%|█████▊    | 1700/2937 [07:36<06:13,  3.31it/s]














 61%|██████    | 1797/2937 [08:05<04:54,  3.87it/s]















 65%|██████▍   | 1902/2937 [08:35<03:18,  5.21it/s]














 68%|██████▊   | 1996/2937 [09:03<04:58,  3.16it/s]


















 72%|███████▏  | 2101/2937 [09:39<07:33,  1.84it/s]




















 75%|███████▍  | 2201/2937 [10:19<04:20,  2.83it/s]



















 78%|███████▊  | 2301/2937 [10:57<02:50,  3.72it/s]















 82%|████████▏ | 2397/2937 [11:26<02:16,  3.95it/s]















 85%|████████▌ | 2500/2937 [11:57<02:51,  2.54it/s]














 88%|████████▊ | 2599/2937 [12:25<01:05,  5.15it/s]














 92%|█████████▏| 2698/2937 [12:53<00:59,  3.99it/s]














 95%|█████████▌| 2800/2937 [13:21<00:30,  4.49it/s]














 99%|█████████▉| 2903/2937 [13:49<00:07,  4.85it/s]



100%|██████████| 2937/2937 [13:57<00:00,  3.51it/s]














                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 157/157 [00:27<00:00,  5.65it/s]
server 0 / 2937 inner epoch 1 round 0 / 50 loss 7.028021812438965 lr 1e-06
                   all       5000      36335      0.525      0.367      0.366        0.2
                   all       5000      36335      0.525      0.367      0.366        0.2










  3%|▎         | 101/2937 [00:21<12:44,  3.71it/s]












  7%|▋         | 204/2937 [00:45<09:12,  4.95it/s]














 10%|█         | 304/2937 [01:13<11:03,  3.97it/s]













 14%|█▎        | 399/2937 [01:38<11:38,  3.63it/s]













 17%|█▋        | 501/2937 [02:05<17:34,  2.31it/s]












 20%|██        | 596/2937 [02:29<06:29,  6.01it/s]












 24%|██▎       | 696/2937 [02:53<07:34,  4.93it/s]












 27%|██▋       | 801/2937 [03:17<07:11,  4.95it/s]













 31%|███       | 899/2937 [03:43<05:44,  5.91it/s]













 34%|███▍      | 999/2937 [04:09<10:01,  3.22it/s]












 37%|███▋      | 1097/2937 [04:33<08:56,  3.43it/s]















 41%|████      | 1200/2937 [05:03<06:47,  4.27it/s]















 44%|████▍     | 1303/2937 [05:33<12:59,  2.10it/s]














 48%|████▊     | 1400/2937 [06:01<06:51,  3.74it/s]














 51%|█████     | 1501/2937 [06:29<07:32,  3.17it/s]













 54%|█████▍    | 1599/2937 [06:55<08:05,  2.75it/s]
















 58%|█████▊    | 1702/2937 [07:27<04:46,  4.31it/s]
















 62%|██████▏   | 1807/2937 [07:59<03:25,  5.50it/s]














 65%|██████▍   | 1904/2937 [08:27<03:58,  4.33it/s]















 68%|██████▊   | 2002/2937 [08:57<03:57,  3.94it/s]

















 72%|███████▏  | 2102/2937 [09:31<05:42,  2.44it/s]




















 75%|███████▍  | 2201/2937 [10:11<07:51,  1.56it/s]


















 78%|███████▊  | 2302/2937 [10:47<03:35,  2.95it/s]















 82%|████████▏ | 2400/2937 [11:17<01:59,  4.48it/s]















 85%|████████▌ | 2500/2937 [11:47<01:54,  3.82it/s]














 89%|████████▊ | 2601/2937 [12:15<01:32,  3.65it/s]














 92%|█████████▏| 2695/2937 [12:44<01:26,  2.79it/s]














 95%|█████████▌| 2799/2937 [13:12<00:42,  3.23it/s]













 99%|█████████▉| 2907/2937 [13:38<00:06,  4.43it/s]



100%|██████████| 2937/2937 [13:45<00:00,  3.56it/s]














                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 157/157 [00:29<00:00,  5.32it/s]
                   all       5000      36335      0.526      0.367      0.367        0.2
                   all       5000      36335      0.526      0.367      0.367        0.2
  0%|          | 6/2937 [00:00<05:17,  9.23it/s]










  3%|▎         | 100/2937 [00:20<10:00,  4.72it/s]












  7%|▋         | 202/2937 [00:44<09:20,  4.88it/s]














 10%|█         | 304/2937 [01:12<13:56,  3.15it/s]












 14%|█▎        | 401/2937 [01:36<10:03,  4.20it/s]














 17%|█▋        | 505/2937 [02:04<10:17,  3.94it/s]













 20%|██        | 599/2937 [02:30<09:13,  4.22it/s]














 24%|██▍       | 699/2937 [02:58<14:03,  2.65it/s]














 27%|██▋       | 802/2937 [03:26<07:53,  4.51it/s]












 31%|███       | 902/2937 [03:50<12:14,  2.77it/s]














 34%|███▍      | 1003/2937 [04:18<06:37,  4.86it/s]














 38%|███▊      | 1106/2937 [04:46<06:53,  4.43it/s]














 41%|████      | 1199/2937 [05:14<08:46,  3.30it/s]














 44%|████▍     | 1298/2937 [05:43<07:54,  3.45it/s]






