
weights: /hdd/hdd3/coco_fl/best.pt
                 from  n    params  module                                  arguments
                 from  n    params  module                                  arguments
  0                -1  1      3520  models.common.Conv                      [3, 32, 6, 2, 2]
  0                -1  1      3520  models.common.Conv                      [3, 32, 6, 2, 2]
  1                -1  1     18560  models.common.Conv                      [32, 64, 3, 2]
  1                -1  1     18560  models.common.Conv                      [32, 64, 3, 2]
  2                -1  1     18816  models.common.C3                        [64, 64, 1]
  2                -1  1     18816  models.common.C3                        [64, 64, 1]
  3                -1  1     73984  models.common.Conv                      [64, 128, 3, 2]
  3                -1  1     73984  models.common.Conv                      [64, 128, 3, 2]
  4                -1  2    115712  models.common.C3                        [128, 128, 2]
  4                -1  2    115712  models.common.C3                        [128, 128, 2]
  5                -1  1    295424  models.common.Conv                      [128, 256, 3, 2]
  5                -1  1    295424  models.common.Conv                      [128, 256, 3, 2]
  6                -1  3    625152  models.common.C3                        [256, 256, 3]
  6                -1  3    625152  models.common.C3                        [256, 256, 3]
  7                -1  1   1180672  models.common.Conv                      [256, 512, 3, 2]
  7                -1  1   1180672  models.common.Conv                      [256, 512, 3, 2]
  8                -1  1   1182720  models.common.C3                        [512, 512, 1]
  8                -1  1   1182720  models.common.C3                        [512, 512, 1]
  9                -1  1    656896  models.common.SPPF                      [512, 512, 5]
  9                -1  1    656896  models.common.SPPF                      [512, 512, 5]
 10                -1  1    131584  models.common.Conv                      [512, 256, 1, 1]
 10                -1  1    131584  models.common.Conv                      [512, 256, 1, 1]
 11                -1  1         0  torch.nn.modules.upsampling.Upsample    [None, 2, 'nearest']
 11                -1  1         0  torch.nn.modules.upsampling.Upsample    [None, 2, 'nearest']
 12           [-1, 6]  1         0  models.common.Concat                    [1]
 12           [-1, 6]  1         0  models.common.Concat                    [1]
 13                -1  1    361984  models.common.C3                        [512, 256, 1, False]
 13                -1  1    361984  models.common.C3                        [512, 256, 1, False]
 14                -1  1     33024  models.common.Conv                      [256, 128, 1, 1]
 14                -1  1     33024  models.common.Conv                      [256, 128, 1, 1]
 15                -1  1         0  torch.nn.modules.upsampling.Upsample    [None, 2, 'nearest']
 15                -1  1         0  torch.nn.modules.upsampling.Upsample    [None, 2, 'nearest']
 16           [-1, 4]  1         0  models.common.Concat                    [1]
 16           [-1, 4]  1         0  models.common.Concat                    [1]
 17                -1  1     90880  models.common.C3                        [256, 128, 1, False]
 17                -1  1     90880  models.common.C3                        [256, 128, 1, False]
 18                -1  1    147712  models.common.Conv                      [128, 128, 3, 2]
 18                -1  1    147712  models.common.Conv                      [128, 128, 3, 2]
 19          [-1, 14]  1         0  models.common.Concat                    [1]
 19          [-1, 14]  1         0  models.common.Concat                    [1]
 20                -1  1    296448  models.common.C3                        [256, 256, 1, False]
 20                -1  1    296448  models.common.C3                        [256, 256, 1, False]
 21                -1  1    590336  models.common.Conv                      [256, 256, 3, 2]
 21                -1  1    590336  models.common.Conv                      [256, 256, 3, 2]
 22          [-1, 10]  1         0  models.common.Concat                    [1]
 22          [-1, 10]  1         0  models.common.Concat                    [1]
 23                -1  1   1182720  models.common.C3                        [512, 512, 1, False]
 23                -1  1   1182720  models.common.C3                        [512, 512, 1, False]
 24      [17, 20, 23]  1    229245  fedmodels.yolov5.models.yolo.Detect     [80, [[10, 13, 16, 30, 33, 23], [30, 61, 62, 45, 59, 119], [116, 90, 156, 198, 373, 326]], [128, 256, 512]]
 24      [17, 20, 23]  1    229245  fedmodels.yolov5.models.yolo.Detect     [80, [[10, 13, 16, 30, 33, 23], [30, 61, 62, 45, 59, 119], [116, 90, 156, 198, 373, 326]], [128, 256, 512]]
YOLOv5s summary: 214 layers, 7235389 parameters, 7235389 gradients, 16.6 GFLOPs
YOLOv5s summary: 214 layers, 7235389 parameters, 7235389 gradients, 16.6 GFLOPs
Transferred 348/349 items from /hdd/hdd3/coco_fl/best.pt
Transferred 348/349 items from /hdd/hdd3/coco_fl/best.pt
Scanning '/hdd/hdd3/coco/labels/val2017.cache' images and labels... 4952 found, 48 missing, 0 empty, 0 corrupt: 100%|██████████| 5000/5000 [00:00<?
Scanning '/hdd/hdd3/coco_fl/labels/node_1_class_56.cache' images and labels... 13148 found, 0 missing, 0 empty, 0 corrupt: 100%|██████████| 13148/1
SGD
================ FL train with total model parameters: 7.2M  ================
++++++++++++++++ Other Train related parameters ++++++++++++++++
               batch_size: 32
                  central: 1
                  clients: [56, 60]
                data_conf: data/coco_custom.yaml
                  dataset: per_class
               decay_type: step
                    epoch: 50
                grad_clip: True
                 img_size: 640
            learning_rate: 1e-06
              local_epoch: 1
            max_grad_norm: 1.0
                 net_name: yolov5s
              num_workers: 8
           optimizer_type: SGD
                  project: FedYOLO
                 save_dir: ./exp/
                     seed: 42
       server_local_epoch: 1
                  shuffle: False
                step_size: 30
                    wandb: True
             warmup_steps: 100
             weight_decay: 0
                  weights: /hdd/hdd3/coco_fl/best.pt
                 yolo_cfg: fedmodels/yolov5/models/yolov5s.yaml
                 yolo_hyp: fedmodels/yolov5/data/hyps/hyp.scratch-low.yaml
++++++++++++++++  End of show parameters ++++++++++++++++
Scanning '/hdd/hdd3/coco_fl/labels/node_2_class_60.cache' images and labels... 10161 found, 0 missing, 0 empty, 0 corrupt: 100%|██████████| 10161/1
Scanning '/hdd/hdd3/coco_fl/labels/server.cache' images and labels... 93957 found, 0 missing, 0 empty, 0 corrupt: 100%|██████████| 93957/93957 [00:
Scanning '/hdd/hdd3/coco/labels/val2017.cache' images and labels... 4952 found, 48 missing, 0 empty, 0 corrupt: 100%|██████████| 5000/5000 [00:00<?













                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 157/157 [00:26<00:00,  5.94it/s]
                   all       5000      36335      0.568       0.38        0.4      0.226
                   all       5000      36335      0.568       0.38        0.4      0.226
[34m[1moptimizer:[39m[22m SGD(lr=1e-06) with parameter groups 57 weight(decay=0.0), 60 weight(decay=0.0005), 60 bias
[34m[1moptimizer:[39m[22m SGD(lr=1e-06) with parameter groups 57 weight(decay=0.0), 60 weight(decay=0.0005), 60 bias
[34m[1moptimizer:[39m[22m SGD(lr=1e-06) with parameter groups 57 weight(decay=0.0), 60 weight(decay=0.0005), 60 bias
[34m[1moptimizer:[39m[22m SGD(lr=1e-06) with parameter groups 57 weight(decay=0.0), 60 weight(decay=0.0005), 60 bias
[34m[1moptimizer:[39m[22m SGD(lr=1e-06) with parameter groups 57 weight(decay=0.0), 60 weight(decay=0.0005), 60 bias
[34m[1moptimizer:[39m[22m SGD(lr=1e-06) with parameter groups 57 weight(decay=0.0), 60 weight(decay=0.0005), 60 bias
  0%|          | 7/2937 [00:00<04:49, 10.11it/s]
=============== start training ===============
---------- training server ----------
train the server of communication round 0










  4%|▎         | 104/2937 [00:20<12:48,  3.69it/s]












  7%|▋         | 202/2937 [00:44<14:05,  3.24it/s]












 10%|█         | 303/2937 [01:08<10:32,  4.16it/s]













 14%|█▎        | 402/2937 [01:34<08:42,  4.85it/s]












 17%|█▋        | 501/2937 [01:59<10:23,  3.91it/s]














 20%|██        | 602/2937 [02:27<07:53,  4.93it/s]













 24%|██▍       | 704/2937 [02:53<08:50,  4.21it/s]














 27%|██▋       | 804/2937 [03:21<09:14,  3.85it/s]













 31%|███       | 904/2937 [03:47<08:04,  4.20it/s]













 34%|███▍      | 1000/2937 [04:13<10:10,  3.17it/s]













 37%|███▋      | 1097/2937 [04:39<06:44,  4.54it/s]















 41%|████      | 1198/2937 [05:09<11:18,  2.56it/s]














 44%|████▍     | 1297/2937 [05:37<06:16,  4.35it/s]















 48%|████▊     | 1400/2937 [06:07<10:37,  2.41it/s]














 51%|█████     | 1501/2937 [06:35<06:09,  3.89it/s]













 54%|█████▍    | 1596/2937 [07:01<05:04,  4.41it/s]

















 58%|█████▊    | 1700/2937 [07:35<06:10,  3.34it/s]














 61%|██████▏   | 1799/2937 [08:03<04:24,  4.30it/s]














 65%|██████▍   | 1896/2937 [08:32<04:48,  3.61it/s]















 68%|██████▊   | 1998/2937 [09:01<03:47,  4.14it/s]

















 71%|███████▏  | 2098/2937 [09:35<07:53,  1.77it/s]




















 75%|███████▍  | 2198/2937 [10:15<05:41,  2.17it/s]



















 78%|███████▊  | 2298/2937 [10:53<03:14,  3.28it/s]















 82%|████████▏ | 2397/2937 [11:23<02:13,  4.03it/s]















 85%|████████▌ | 2501/2937 [11:53<02:56,  2.46it/s]














 89%|████████▊ | 2600/2937 [12:21<01:28,  3.82it/s]














 92%|█████████▏| 2701/2937 [12:49<01:01,  3.85it/s]













 95%|█████████▌| 2794/2937 [13:16<00:39,  3.61it/s]














 99%|█████████▊| 2898/2937 [13:44<00:09,  3.95it/s]




100%|██████████| 2937/2937 [13:52<00:00,  3.53it/s]














                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 157/157 [00:29<00:00,  5.34it/s]
                   all       5000      36335      0.525      0.367      0.366        0.2
                   all       5000      36335      0.525      0.367      0.366        0.2
[34m[1mAMP: [39m[22mchecks passed ✅
[34m[1mAMP: [39m[22mchecks passed ✅
  0%|          | 0/411 [00:00<?, ?it/s]
 ========== finish to train server ==========
train the client 0 of communication round 0













 24%|██▍       | 98/411 [00:26<01:59,  2.63it/s]














 48%|████▊     | 198/411 [00:54<00:56,  3.79it/s]
















 73%|███████▎  | 299/411 [01:25<00:33,  3.38it/s]
















 98%|█████████▊| 401/411 [01:58<00:02,  4.35it/s]

100%|██████████| 411/411 [02:00<00:00,  3.41it/s]












                 Class     Images  Instances          P          R      mAP50   mAP50-95:  99%|█████████▉| 156/157 [00:25<00:00,  6.84it/s]
train the client 1 of communication round 0
                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 157/157 [00:25<00:00,  6.08it/s]
                   all       5000      36335      0.548      0.353      0.367      0.207
                   all       5000      36335      0.548      0.353      0.367      0.207
[34m[1mAMP: [39m[22mchecks passed ✅
[34m[1mAMP: [39m[22mchecks passed ✅












 31%|███       | 98/318 [00:24<01:03,  3.45it/s]














 62%|██████▏   | 197/318 [00:52<00:36,  3.33it/s]















 94%|█████████▍| 300/318 [01:22<00:05,  3.48it/s]

100%|██████████| 318/318 [01:27<00:00,  3.65it/s]













                 Class     Images  Instances          P          R      mAP50   mAP50-95:  97%|█████████▋| 153/157 [00:25<00:00,  6.75it/s]
---- calculate the model avg ----
                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 157/157 [00:26<00:00,  6.03it/s]
                   all       5000      36335      0.571      0.324      0.343      0.193
                   all       5000      36335      0.571      0.324      0.343      0.193













                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 157/157 [00:27<00:00,  5.77it/s]
                   all       5000      36335      0.584       0.38      0.401      0.228
                   all       5000      36335      0.584       0.38      0.401      0.228
  0%|          | 1/2937 [00:00<08:10,  5.99it/s]
---------- training server ----------
train the server of communication round 1









  3%|▎         | 98/2937 [00:18<11:54,  3.97it/s]











  7%|▋         | 194/2937 [00:39<08:26,  5.42it/s]













 10%|█         | 296/2937 [01:06<13:40,  3.22it/s]













 14%|█▎        | 400/2937 [01:32<08:54,  4.75it/s]













 17%|█▋        | 495/2937 [01:58<09:04,  4.48it/s]














 20%|██        | 598/2937 [02:26<08:04,  4.83it/s]














 24%|██▍       | 702/2937 [02:54<08:38,  4.31it/s]













 27%|██▋       | 802/2937 [03:20<08:09,  4.36it/s]













 31%|███       | 902/2937 [03:46<09:49,  3.45it/s]













 34%|███▍      | 998/2937 [04:12<06:38,  4.87it/s]















 38%|███▊      | 1103/2937 [04:42<09:43,  3.14it/s]















 41%|████      | 1202/2937 [05:12<09:35,  3.01it/s]














 44%|████▍     | 1297/2937 [05:40<13:00,  2.10it/s]















 48%|████▊     | 1398/2937 [06:10<08:43,  2.94it/s]















 51%|█████     | 1498/2937 [06:40<06:26,  3.72it/s]

















 54%|█████▍    | 1598/2937 [07:12<06:30,  3.43it/s]
















 58%|█████▊    | 1705/2937 [07:45<04:41,  4.38it/s]













 61%|██████    | 1797/2937 [08:11<05:41,  3.34it/s]















 65%|██████▍   | 1899/2937 [08:40<03:55,  4.41it/s]
















 68%|██████▊   | 2002/2937 [09:12<04:17,  3.63it/s]

















 71%|███████▏  | 2096/2937 [09:46<05:08,  2.72it/s]

















 75%|███████▍  | 2200/2937 [10:20<04:24,  2.78it/s]


















 78%|███████▊  | 2299/2937 [10:57<03:27,  3.07it/s]















 82%|████████▏ | 2395/2937 [11:27<02:27,  3.68it/s]
















 85%|████████▌ | 2502/2937 [11:59<01:50,  3.95it/s]














 89%|████████▊ | 2602/2937 [12:26<01:23,  4.02it/s]














 92%|█████████▏| 2705/2937 [12:55<00:47,  4.93it/s]














 95%|█████████▌| 2801/2937 [13:23<00:28,  4.75it/s]














 99%|█████████▉| 2902/2937 [13:51<00:10,  3.49it/s]




100%|██████████| 2937/2937 [14:01<00:00,  3.49it/s]














                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 157/157 [00:28<00:00,  5.48it/s]
                   all       5000      36335      0.482      0.343      0.322       0.17
                   all       5000      36335      0.482      0.343      0.322       0.17
[34m[1mAMP: [39m[22mchecks passed ✅
[34m[1mAMP: [39m[22mchecks passed ✅
  0%|          | 2/411 [00:00<00:41,  9.80it/s]
 ========== finish to train server ==========
train the client 0 of communication round 1












 28%|██▊       | 117/411 [00:28<00:59,  4.91it/s]











 48%|████▊     | 197/411 [00:50<01:02,  3.41it/s]
















 73%|███████▎  | 300/411 [01:22<00:40,  2.76it/s]
















 97%|█████████▋| 398/411 [01:53<00:04,  3.25it/s]

100%|██████████| 411/411 [01:58<00:00,  3.48it/s]
                 Class     Images  Instances          P          R      mAP50   mAP50-95:   8%|▊         | 12/157 [00:02<00:27,  5.25it/s]
                 Class     Images  Instances          P          R      mAP50   mAP50-95:  15%|█▍        | 23/157 [00:04<00:25,  5.36it/s]
                 Class     Images  Instances          P          R      mAP50   mAP50-95:  22%|██▏       | 34/157 [00:06<00:21,  5.86it/s]
                 Class     Images  Instances          P          R      mAP50   mAP50-95:  29%|██▉       | 46/157 [00:08<00:19,  5.78it/s]
                 Class     Images  Instances          P          R      mAP50   mAP50-95:  36%|███▋      | 57/157 [00:10<00:18,  5.47it/s]
                 Class     Images  Instances          P          R      mAP50   mAP50-95:  44%|████▍     | 69/157 [00:12<00:15,  5.78it/s]
                 Class     Images  Instances          P          R      mAP50   mAP50-95:  50%|█████     | 79/157 [00:14<00:15,  5.15it/s]
                 Class     Images  Instances          P          R      mAP50   mAP50-95:  57%|█████▋    | 90/157 [00:16<00:13,  5.04it/s]
                 Class     Images  Instances          P          R      mAP50   mAP50-95:  64%|██████▍   | 101/157 [00:18<00:11,  5.02it/s]
                 Class     Images  Instances          P          R      mAP50   mAP50-95:  71%|███████▏  | 112/157 [00:20<00:07,  5.74it/s]
                 Class     Images  Instances          P          R      mAP50   mAP50-95:  78%|███████▊  | 122/157 [00:22<00:06,  5.62it/s]
                 Class     Images  Instances          P          R      mAP50   mAP50-95:  85%|████████▍ | 133/157 [00:24<00:03,  6.11it/s]
                 Class     Images  Instances          P          R      mAP50   mAP50-95:  92%|█████████▏| 144/157 [00:26<00:02,  5.38it/s]
                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 157/157 [00:28<00:00,  5.54it/s]
  1%|          | 3/318 [00:00<01:10,  4.47it/s]
  1%|          | 3/318 [00:00<01:10,  4.47it/s]
train the client 1 of communication round 1
  4%|▍         | 12/318 [00:02<01:00,  5.09it/s]
  5%|▌         | 17/318 [00:04<01:31,  3.28it/s]
  8%|▊         | 27/318 [00:06<01:03,  4.61it/s]
 11%|█▏        | 36/318 [00:08<00:54,  5.16it/s]
 14%|█▎        | 43/318 [00:10<01:09,  3.95it/s]
 16%|█▋        | 52/318 [00:12<00:50,  5.26it/s]
 19%|█▊        | 59/318 [00:14<01:34,  2.74it/s]
 21%|██        | 66/318 [00:16<01:07,  3.75it/s]
 23%|██▎       | 74/318 [00:18<00:57,  4.23it/s]
 26%|██▌       | 82/318 [00:20<00:52,  4.47it/s]
 29%|██▊       | 91/318 [00:22<00:50,  4.49it/s]
 30%|███       | 96/318 [00:24<01:02,  3.58it/s]
 33%|███▎      | 104/318 [00:26<00:49,  4.29it/s]
 33%|███▎      | 104/318 [00:26<00:49,  4.29it/s]
 34%|███▍      | 109/318 [00:28<01:14,  2.82it/s]
 37%|███▋      | 117/318 [00:30<00:47,  4.24it/s]
 38%|███▊      | 122/318 [00:31<00:38,  5.05it/s]
 53%|█████▎    | 169/318 [00:44<00:31,  4.78it/s]
 55%|█████▌    | 176/318 [00:46<00:36,  3.92it/s]
 57%|█████▋    | 182/318 [00:47<00:35,  3.82it/s]
 59%|█████▉    | 188/318 [00:50<00:41,  3.14it/s]
 62%|██████▏   | 198/318 [00:52<00:26,  4.60it/s]
 64%|██████▍   | 204/318 [00:54<00:28,  3.99it/s]
 64%|██████▍   | 204/318 [00:54<00:28,  3.99it/s]
 67%|██████▋   | 212/318 [00:56<00:28,  3.75it/s]
 68%|██████▊   | 217/318 [00:58<00:33,  3.00it/s]
 70%|███████   | 224/318 [01:00<00:28,  3.34it/s]
 72%|███████▏  | 230/318 [01:02<00:25,  3.50it/s]
 74%|███████▎  | 234/318 [01:03<00:30,  2.75it/s]
 75%|███████▌  | 239/318 [01:06<00:37,  2.13it/s]
