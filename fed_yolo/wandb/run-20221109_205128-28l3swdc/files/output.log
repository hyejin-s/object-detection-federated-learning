
weights: /hdd/hdd3/coco_fl/best.pt
                 from  n    params  module                                  arguments
                 from  n    params  module                                  arguments
  0                -1  1      3520  models.common.Conv                      [3, 32, 6, 2, 2]
  0                -1  1      3520  models.common.Conv                      [3, 32, 6, 2, 2]
  1                -1  1     18560  models.common.Conv                      [32, 64, 3, 2]
  1                -1  1     18560  models.common.Conv                      [32, 64, 3, 2]
  2                -1  1     18816  models.common.C3                        [64, 64, 1]
  2                -1  1     18816  models.common.C3                        [64, 64, 1]
  3                -1  1     73984  models.common.Conv                      [64, 128, 3, 2]
  3                -1  1     73984  models.common.Conv                      [64, 128, 3, 2]
  4                -1  2    115712  models.common.C3                        [128, 128, 2]
  4                -1  2    115712  models.common.C3                        [128, 128, 2]
  5                -1  1    295424  models.common.Conv                      [128, 256, 3, 2]
  5                -1  1    295424  models.common.Conv                      [128, 256, 3, 2]
  6                -1  3    625152  models.common.C3                        [256, 256, 3]
  6                -1  3    625152  models.common.C3                        [256, 256, 3]
  7                -1  1   1180672  models.common.Conv                      [256, 512, 3, 2]
  7                -1  1   1180672  models.common.Conv                      [256, 512, 3, 2]
  8                -1  1   1182720  models.common.C3                        [512, 512, 1]
  8                -1  1   1182720  models.common.C3                        [512, 512, 1]
  9                -1  1    656896  models.common.SPPF                      [512, 512, 5]
  9                -1  1    656896  models.common.SPPF                      [512, 512, 5]
 10                -1  1    131584  models.common.Conv                      [512, 256, 1, 1]
 10                -1  1    131584  models.common.Conv                      [512, 256, 1, 1]
 11                -1  1         0  torch.nn.modules.upsampling.Upsample    [None, 2, 'nearest']
 11                -1  1         0  torch.nn.modules.upsampling.Upsample    [None, 2, 'nearest']
 12           [-1, 6]  1         0  models.common.Concat                    [1]
 12           [-1, 6]  1         0  models.common.Concat                    [1]
 13                -1  1    361984  models.common.C3                        [512, 256, 1, False]
 13                -1  1    361984  models.common.C3                        [512, 256, 1, False]
 14                -1  1     33024  models.common.Conv                      [256, 128, 1, 1]
 14                -1  1     33024  models.common.Conv                      [256, 128, 1, 1]
 15                -1  1         0  torch.nn.modules.upsampling.Upsample    [None, 2, 'nearest']
 15                -1  1         0  torch.nn.modules.upsampling.Upsample    [None, 2, 'nearest']
 16           [-1, 4]  1         0  models.common.Concat                    [1]
 16           [-1, 4]  1         0  models.common.Concat                    [1]
 17                -1  1     90880  models.common.C3                        [256, 128, 1, False]
 17                -1  1     90880  models.common.C3                        [256, 128, 1, False]
 18                -1  1    147712  models.common.Conv                      [128, 128, 3, 2]
 18                -1  1    147712  models.common.Conv                      [128, 128, 3, 2]
 19          [-1, 14]  1         0  models.common.Concat                    [1]
 19          [-1, 14]  1         0  models.common.Concat                    [1]
 20                -1  1    296448  models.common.C3                        [256, 256, 1, False]
 20                -1  1    296448  models.common.C3                        [256, 256, 1, False]
 21                -1  1    590336  models.common.Conv                      [256, 256, 3, 2]
 21                -1  1    590336  models.common.Conv                      [256, 256, 3, 2]
 22          [-1, 10]  1         0  models.common.Concat                    [1]
 22          [-1, 10]  1         0  models.common.Concat                    [1]
 23                -1  1   1182720  models.common.C3                        [512, 512, 1, False]
 23                -1  1   1182720  models.common.C3                        [512, 512, 1, False]
 24      [17, 20, 23]  1    229245  fedmodels.yolov5.models.yolo.Detect     [80, [[10, 13, 16, 30, 33, 23], [30, 61, 62, 45, 59, 119], [116, 90, 156, 198, 373, 326]], [128, 256, 512]]
 24      [17, 20, 23]  1    229245  fedmodels.yolov5.models.yolo.Detect     [80, [[10, 13, 16, 30, 33, 23], [30, 61, 62, 45, 59, 119], [116, 90, 156, 198, 373, 326]], [128, 256, 512]]
SGD
================ FL train with total model parameters: 7.2M  ================
++++++++++++++++ Other Train related parameters ++++++++++++++++
               batch_size: 32
                  central: 1
                  clients: [56, 60]
                data_conf: data/coco_custom.yaml
                  dataset: per_class
               decay_type: step
                    epoch: 50
                grad_clip: True
                 img_size: 640
            learning_rate: 1e-06
              local_epoch: 5
            max_grad_norm: 1.0
                 net_name: yolov5s
              num_workers: 8
           optimizer_type: SGD
                  project: FedYOLO
                 save_dir: ./exp/
                     seed: 42
       server_local_epoch: 2
                  shuffle: False
                step_size: 30
                    wandb: True
             warmup_steps: 100
             weight_decay: 0
                  weights: /hdd/hdd3/coco_fl/best.pt
                 yolo_cfg: fedmodels/yolov5/models/yolov5s.yaml
                 yolo_hyp: fedmodels/yolov5/data/hyps/hyp.scratch-low.yaml
++++++++++++++++  End of show parameters ++++++++++++++++
YOLOv5s summary: 214 layers, 7235389 parameters, 7235389 gradients, 16.6 GFLOPs
YOLOv5s summary: 214 layers, 7235389 parameters, 7235389 gradients, 16.6 GFLOPs
Transferred 348/349 items from /hdd/hdd3/coco_fl/best.pt
Transferred 348/349 items from /hdd/hdd3/coco_fl/best.pt
Scanning '/hdd/hdd3/coco/labels/val2017.cache' images and labels... 4952 found, 48 missing, 0 empty, 0 corrupt: 100%|██████████| 5000/5000 [00:00<?
Scanning '/hdd/hdd3/coco_fl/labels/node_1_class_56.cache' images and labels... 13148 found, 0 missing, 0 empty, 0 corrupt: 100%|██████████| 13148/1
Scanning '/hdd/hdd3/coco_fl/labels/node_2_class_60.cache' images and labels... 10161 found, 0 missing, 0 empty, 0 corrupt: 100%|██████████| 10161/1
Scanning '/hdd/hdd3/coco_fl/labels/server.cache' images and labels... 93957 found, 0 missing, 0 empty, 0 corrupt: 100%|██████████| 93957/93957 [00:
Scanning '/hdd/hdd3/coco/labels/val2017.cache' images and labels... 4952 found, 48 missing, 0 empty, 0 corrupt: 100%|██████████| 5000/5000 [00:00<?














                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 157/157 [00:27<00:00,  5.73it/s]
                   all       5000      36335      0.568       0.38        0.4      0.226
                   all       5000      36335      0.568       0.38        0.4      0.226
[34m[1moptimizer:[39m[22m SGD(lr=1e-06) with parameter groups 57 weight(decay=0.0), 60 weight(decay=0.0005), 60 bias
[34m[1moptimizer:[39m[22m SGD(lr=1e-06) with parameter groups 57 weight(decay=0.0), 60 weight(decay=0.0005), 60 bias
[34m[1moptimizer:[39m[22m SGD(lr=1e-06) with parameter groups 57 weight(decay=0.0), 60 weight(decay=0.0005), 60 bias
[34m[1moptimizer:[39m[22m SGD(lr=1e-06) with parameter groups 57 weight(decay=0.0), 60 weight(decay=0.0005), 60 bias
[34m[1moptimizer:[39m[22m SGD(lr=1e-06) with parameter groups 57 weight(decay=0.0), 60 weight(decay=0.0005), 60 bias
[34m[1moptimizer:[39m[22m SGD(lr=1e-06) with parameter groups 57 weight(decay=0.0), 60 weight(decay=0.0005), 60 bias
  0%|          | 3/2937 [00:00<05:00,  9.78it/s]
=============== start training ===============
---------- training server ----------
train the server of communication round 0









  3%|▎         | 95/2937 [00:18<07:53,  6.00it/s]












  7%|▋         | 197/2937 [00:42<09:56,  4.59it/s]












 10%|█         | 298/2937 [01:06<11:13,  3.92it/s]













 13%|█▎        | 396/2937 [01:32<11:13,  3.77it/s]












 17%|█▋        | 494/2937 [01:56<11:17,  3.61it/s]














 20%|██        | 594/2937 [02:24<09:45,  4.00it/s]













 24%|██▍       | 698/2937 [02:50<11:41,  3.19it/s]














 27%|██▋       | 799/2937 [03:18<09:51,  3.61it/s]













 31%|███       | 899/2937 [03:45<07:56,  4.27it/s]













 34%|███▍      | 997/2937 [04:11<09:17,  3.48it/s]














 37%|███▋      | 1099/2937 [04:38<08:35,  3.57it/s]















 41%|████      | 1200/2937 [05:08<10:55,  2.65it/s]














 44%|████▍     | 1298/2937 [05:36<10:33,  2.59it/s]














 48%|████▊     | 1397/2937 [06:04<07:20,  3.50it/s]














 51%|█████     | 1498/2937 [06:33<05:38,  4.25it/s]














 54%|█████▍    | 1598/2937 [07:00<06:19,  3.53it/s]
















 58%|█████▊    | 1699/2937 [07:33<05:53,  3.50it/s]














 61%|██████    | 1797/2937 [08:01<04:48,  3.95it/s]














 64%|██████▍   | 1893/2937 [08:29<05:26,  3.20it/s]















 68%|██████▊   | 1998/2937 [08:59<03:34,  4.37it/s]

















 72%|███████▏  | 2100/2937 [09:33<06:58,  2.00it/s]




















 75%|███████▍  | 2201/2937 [10:13<04:16,  2.87it/s]


















 78%|███████▊  | 2294/2937 [10:49<02:57,  3.62it/s]
















 82%|████████▏ | 2401/2937 [11:21<02:48,  3.18it/s]














 85%|████████▌ | 2499/2937 [11:49<02:05,  3.49it/s]














 88%|████████▊ | 2599/2937 [12:17<01:04,  5.22it/s]














 92%|█████████▏| 2698/2937 [12:45<00:59,  4.04it/s]














 95%|█████████▌| 2801/2937 [13:13<00:38,  3.53it/s]













 99%|█████████▊| 2895/2937 [13:39<00:10,  3.99it/s]




100%|██████████| 2937/2937 [13:48<00:00,  3.55it/s]















                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 157/157 [00:30<00:00,  5.22it/s]
server 0 / 2937 inner epoch 1 round 0 / 50 loss 7.02867317199707 lr 1e-06
                   all       5000      36335      0.525      0.367      0.366        0.2
                   all       5000      36335      0.525      0.367      0.366        0.2









  3%|▎         | 95/2937 [00:19<13:42,  3.46it/s]












  7%|▋         | 198/2937 [00:43<10:07,  4.51it/s]














 10%|█         | 300/2937 [01:11<12:02,  3.65it/s]













 14%|█▎        | 398/2937 [01:37<08:38,  4.90it/s]










 17%|█▋        | 496/2937 [02:01<14:19,  2.84it/s]













 20%|██        | 598/2937 [02:27<08:14,  4.73it/s]












 24%|██▍       | 700/2937 [02:51<06:19,  5.90it/s]











 27%|██▋       | 797/2937 [03:14<07:08,  5.00it/s]













 31%|███       | 896/2937 [03:40<09:02,  3.76it/s]













 34%|███▍      | 999/2937 [04:06<09:49,  3.29it/s]












 37%|███▋      | 1099/2937 [04:30<07:34,  4.04it/s]














 41%|████      | 1197/2937 [04:58<06:10,  4.69it/s]















 44%|████▍     | 1301/2937 [05:28<15:09,  1.80it/s]














 48%|████▊     | 1398/2937 [05:56<05:21,  4.78it/s]














 51%|█████     | 1500/2937 [06:23<06:09,  3.89it/s]













 54%|█████▍    | 1600/2937 [06:50<07:42,  2.89it/s]















 58%|█████▊    | 1697/2937 [07:20<06:02,  3.42it/s]
















 61%|██████▏   | 1804/2937 [07:52<02:58,  6.35it/s]













 64%|██████▍   | 1894/2937 [08:18<06:32,  2.66it/s]















 68%|██████▊   | 1998/2937 [08:48<04:27,  3.52it/s]

















 72%|███████▏  | 2101/2937 [09:22<06:49,  2.04it/s]




















 75%|███████▍  | 2201/2937 [10:02<07:44,  1.59it/s]

















 78%|███████▊  | 2299/2937 [10:36<03:02,  3.49it/s]















 82%|████████▏ | 2397/2937 [11:06<02:05,  4.30it/s]















 85%|████████▌ | 2499/2937 [11:36<02:05,  3.49it/s]














 89%|████████▊ | 2603/2937 [12:04<01:15,  4.42it/s]














 92%|█████████▏| 2699/2937 [12:32<00:44,  5.29it/s]














 95%|█████████▌| 2803/2937 [13:00<00:28,  4.77it/s]












 99%|█████████▉| 2904/2937 [13:25<00:06,  5.20it/s]



100%|██████████| 2937/2937 [13:32<00:00,  3.61it/s]















                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 157/157 [00:29<00:00,  5.39it/s]
 ========== finish to train server ==========
train the client 0 of communication round 0
client 0 0 / 411 inner epoch 0 round 0 / 50 loss 8.747014999389648 lr 1e-06
                   all       5000      36335      0.526      0.367      0.367        0.2
                   all       5000      36335      0.526      0.367      0.367        0.2
[34m[1mAMP: [39m[22mchecks passed ✅
[34m[1mAMP: [39m[22mchecks passed ✅












 24%|██▍       | 98/411 [00:25<01:37,  3.21it/s]














 48%|████▊     | 198/411 [00:53<01:06,  3.18it/s]















 73%|███████▎  | 299/411 [01:23<00:27,  4.05it/s]














 96%|█████████▌| 394/411 [01:51<00:05,  3.28it/s]


100%|██████████| 411/411 [01:56<00:00,  3.54it/s]












                 Class     Images  Instances          P          R      mAP50   mAP50-95:  99%|█████████▊| 155/157 [00:25<00:00,  6.63it/s]
                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 157/157 [00:26<00:00,  6.01it/s]
                   all       5000      36335      0.549      0.353      0.367      0.207
                   all       5000      36335      0.549      0.353      0.367      0.207













 25%|██▌       | 103/411 [00:26<02:02,  2.51it/s]













 48%|████▊     | 199/411 [00:52<00:54,  3.89it/s]
















 73%|███████▎  | 299/411 [01:24<00:43,  2.60it/s]















 98%|█████████▊| 401/411 [01:55<00:01,  5.34it/s]

100%|██████████| 411/411 [01:57<00:00,  3.49it/s]












                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 157/157 [00:26<00:00,  5.95it/s]
                   all       5000      36335      0.549      0.352      0.366      0.207
                   all       5000      36335      0.549      0.352      0.366      0.207
  0%|          | 1/411 [00:00<00:52,  7.77it/s]












 25%|██▌       | 103/411 [00:24<01:33,  3.28it/s]














 49%|████▊     | 200/411 [00:52<01:01,  3.41it/s]















 73%|███████▎  | 300/411 [01:21<00:36,  3.04it/s]















 97%|█████████▋| 397/411 [01:51<00:04,  3.42it/s]

100%|██████████| 411/411 [01:55<00:00,  3.56it/s]

