
weights: /hdd/hdd3/coco_fl/best.pt
                 from  n    params  module                                  arguments
                 from  n    params  module                                  arguments
  0                -1  1      3520  models.common.Conv                      [3, 32, 6, 2, 2]
  0                -1  1      3520  models.common.Conv                      [3, 32, 6, 2, 2]
  1                -1  1     18560  models.common.Conv                      [32, 64, 3, 2]
  1                -1  1     18560  models.common.Conv                      [32, 64, 3, 2]
  2                -1  1     18816  models.common.C3                        [64, 64, 1]
  2                -1  1     18816  models.common.C3                        [64, 64, 1]
  3                -1  1     73984  models.common.Conv                      [64, 128, 3, 2]
  3                -1  1     73984  models.common.Conv                      [64, 128, 3, 2]
  4                -1  2    115712  models.common.C3                        [128, 128, 2]
  4                -1  2    115712  models.common.C3                        [128, 128, 2]
  5                -1  1    295424  models.common.Conv                      [128, 256, 3, 2]
  5                -1  1    295424  models.common.Conv                      [128, 256, 3, 2]
  6                -1  3    625152  models.common.C3                        [256, 256, 3]
  6                -1  3    625152  models.common.C3                        [256, 256, 3]
  7                -1  1   1180672  models.common.Conv                      [256, 512, 3, 2]
  7                -1  1   1180672  models.common.Conv                      [256, 512, 3, 2]
  8                -1  1   1182720  models.common.C3                        [512, 512, 1]
  8                -1  1   1182720  models.common.C3                        [512, 512, 1]
  9                -1  1    656896  models.common.SPPF                      [512, 512, 5]
  9                -1  1    656896  models.common.SPPF                      [512, 512, 5]
 10                -1  1    131584  models.common.Conv                      [512, 256, 1, 1]
 10                -1  1    131584  models.common.Conv                      [512, 256, 1, 1]
 11                -1  1         0  torch.nn.modules.upsampling.Upsample    [None, 2, 'nearest']
 11                -1  1         0  torch.nn.modules.upsampling.Upsample    [None, 2, 'nearest']
 12           [-1, 6]  1         0  models.common.Concat                    [1]
 12           [-1, 6]  1         0  models.common.Concat                    [1]
 13                -1  1    361984  models.common.C3                        [512, 256, 1, False]
 13                -1  1    361984  models.common.C3                        [512, 256, 1, False]
 14                -1  1     33024  models.common.Conv                      [256, 128, 1, 1]
 14                -1  1     33024  models.common.Conv                      [256, 128, 1, 1]
 15                -1  1         0  torch.nn.modules.upsampling.Upsample    [None, 2, 'nearest']
 15                -1  1         0  torch.nn.modules.upsampling.Upsample    [None, 2, 'nearest']
 16           [-1, 4]  1         0  models.common.Concat                    [1]
 16           [-1, 4]  1         0  models.common.Concat                    [1]
 17                -1  1     90880  models.common.C3                        [256, 128, 1, False]
 17                -1  1     90880  models.common.C3                        [256, 128, 1, False]
 18                -1  1    147712  models.common.Conv                      [128, 128, 3, 2]
 18                -1  1    147712  models.common.Conv                      [128, 128, 3, 2]
 19          [-1, 14]  1         0  models.common.Concat                    [1]
 19          [-1, 14]  1         0  models.common.Concat                    [1]
 20                -1  1    296448  models.common.C3                        [256, 256, 1, False]
 20                -1  1    296448  models.common.C3                        [256, 256, 1, False]
 21                -1  1    590336  models.common.Conv                      [256, 256, 3, 2]
 21                -1  1    590336  models.common.Conv                      [256, 256, 3, 2]
 22          [-1, 10]  1         0  models.common.Concat                    [1]
 22          [-1, 10]  1         0  models.common.Concat                    [1]
 23                -1  1   1182720  models.common.C3                        [512, 512, 1, False]
 23                -1  1   1182720  models.common.C3                        [512, 512, 1, False]
 24      [17, 20, 23]  1    229245  fedmodels.yolov5.models.yolo.Detect     [80, [[10, 13, 16, 30, 33, 23], [30, 61, 62, 45, 59, 119], [116, 90, 156, 198, 373, 326]], [128, 256, 512]]
 24      [17, 20, 23]  1    229245  fedmodels.yolov5.models.yolo.Detect     [80, [[10, 13, 16, 30, 33, 23], [30, 61, 62, 45, 59, 119], [116, 90, 156, 198, 373, 326]], [128, 256, 512]]
YOLOv5s summary: 214 layers, 7235389 parameters, 7235389 gradients, 16.6 GFLOPs
YOLOv5s summary: 214 layers, 7235389 parameters, 7235389 gradients, 16.6 GFLOPs
Transferred 348/349 items from /hdd/hdd3/coco_fl/best.pt
Transferred 348/349 items from /hdd/hdd3/coco_fl/best.pt
Scanning '/hdd/hdd3/coco/labels/val2017.cache' images and labels... 4952 found, 48 missing, 0 empty, 0 corrupt: 100%|██████████| 5000/5000 [00:00<?
SGD
================ FL train with total model parameters: 7.2M  ================
++++++++++++++++ Other Train related parameters ++++++++++++++++
               batch_size: 32
                  central: 1
                  clients: [56, 60]
                data_conf: data/coco_custom.yaml
                  dataset: per_class
               decay_type: step
                    epoch: 50
                grad_clip: True
                 img_size: 640
            learning_rate: 1e-06
              local_epoch: 1
            max_grad_norm: 1.0
                 net_name: yolov5s
              num_workers: 8
           optimizer_type: SGD
                  project: FedYOLO
                 save_dir: ./exp/
                     seed: 42
       server_local_epoch: 2
                  shuffle: False
                step_size: 30
                    wandb: True
             warmup_steps: 100
             weight_decay: 0
                  weights: /hdd/hdd3/coco_fl/best.pt
                 yolo_cfg: fedmodels/yolov5/models/yolov5s.yaml
                 yolo_hyp: fedmodels/yolov5/data/hyps/hyp.scratch-low.yaml
++++++++++++++++  End of show parameters ++++++++++++++++
Scanning '/hdd/hdd3/coco_fl/labels/node_1_class_56.cache' images and labels... 13148 found, 0 missing, 0 empty, 0 corrupt: 100%|██████████| 13148/1
Scanning '/hdd/hdd3/coco_fl/labels/node_2_class_60.cache' images and labels... 10161 found, 0 missing, 0 empty, 0 corrupt: 100%|██████████| 10161/1
Scanning '/hdd/hdd3/coco_fl/labels/server.cache' images and labels... 93957 found, 0 missing, 0 empty, 0 corrupt: 100%|██████████| 93957/93957 [00:
Scanning '/hdd/hdd3/coco/labels/val2017.cache' images and labels... 4952 found, 48 missing, 0 empty, 0 corrupt: 100%|██████████| 5000/5000 [00:00<?













                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 157/157 [00:27<00:00,  5.81it/s]
                   all       5000      36335      0.568       0.38        0.4      0.226
                   all       5000      36335      0.568       0.38        0.4      0.226
[34m[1moptimizer:[39m[22m SGD(lr=1e-06) with parameter groups 57 weight(decay=0.0), 60 weight(decay=0.0005), 60 bias
[34m[1moptimizer:[39m[22m SGD(lr=1e-06) with parameter groups 57 weight(decay=0.0), 60 weight(decay=0.0005), 60 bias
[34m[1moptimizer:[39m[22m SGD(lr=1e-06) with parameter groups 57 weight(decay=0.0), 60 weight(decay=0.0005), 60 bias
[34m[1moptimizer:[39m[22m SGD(lr=1e-06) with parameter groups 57 weight(decay=0.0), 60 weight(decay=0.0005), 60 bias
[34m[1moptimizer:[39m[22m SGD(lr=1e-06) with parameter groups 57 weight(decay=0.0), 60 weight(decay=0.0005), 60 bias
[34m[1moptimizer:[39m[22m SGD(lr=1e-06) with parameter groups 57 weight(decay=0.0), 60 weight(decay=0.0005), 60 bias
  0%|          | 9/2937 [00:00<05:10,  9.44it/s]
=============== start training ===============
---------- training server ----------
train the server of communication round 0










  4%|▎         | 105/2937 [00:21<12:33,  3.76it/s]












  7%|▋         | 204/2937 [00:44<10:35,  4.30it/s]












 10%|█         | 304/2937 [01:09<14:48,  2.96it/s]













 14%|█▍        | 406/2937 [01:35<08:52,  4.75it/s]












 17%|█▋        | 504/2937 [01:58<10:52,  3.73it/s]













 20%|██        | 596/2937 [02:24<08:53,  4.39it/s]













 24%|██▍       | 700/2937 [02:51<10:06,  3.69it/s]














 27%|██▋       | 800/2937 [03:19<11:53,  3.00it/s]













 31%|███       | 899/2937 [03:44<07:52,  4.32it/s]













 34%|███▍      | 997/2937 [04:11<09:22,  3.45it/s]














 37%|███▋      | 1100/2937 [04:39<11:55,  2.57it/s]














 41%|████      | 1196/2937 [05:07<11:36,  2.50it/s]















 44%|████▍     | 1297/2937 [05:37<06:22,  4.29it/s]















 48%|████▊     | 1400/2937 [06:07<10:36,  2.42it/s]














 51%|█████     | 1501/2937 [06:35<06:12,  3.86it/s]













 54%|█████▍    | 1596/2937 [07:01<05:02,  4.43it/s]

















 58%|█████▊    | 1700/2937 [07:35<06:11,  3.33it/s]














 61%|██████▏   | 1799/2937 [08:03<04:26,  4.28it/s]














 65%|██████▍   | 1896/2937 [08:32<04:50,  3.59it/s]















 68%|██████▊   | 2000/2937 [09:01<04:05,  3.82it/s]

















 72%|███████▏  | 2100/2937 [09:36<07:00,  1.99it/s]




















 75%|███████▍  | 2201/2937 [10:16<04:16,  2.87it/s]



















 78%|███████▊  | 2300/2937 [10:54<03:07,  3.39it/s]















 82%|████████▏ | 2397/2937 [11:23<02:14,  4.02it/s]















 85%|████████▌ | 2500/2937 [11:53<02:49,  2.57it/s]














 89%|████████▊ | 2600/2937 [12:22<01:26,  3.89it/s]














 92%|█████████▏| 2702/2937 [12:50<00:58,  3.99it/s]













 95%|█████████▌| 2794/2937 [13:16<00:39,  3.63it/s]














 99%|█████████▊| 2898/2937 [13:44<00:09,  3.95it/s]




100%|██████████| 2937/2937 [13:52<00:00,  3.53it/s]














                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 157/157 [00:28<00:00,  5.48it/s]
server 0 / 2937 inner epoch 1 round 0 / 50 loss 7.028670787811279 lr 1e-06
                   all       5000      36335      0.525      0.367      0.366        0.2
                   all       5000      36335      0.525      0.367      0.366        0.2










  3%|▎         | 102/2937 [00:21<10:48,  4.37it/s]











  7%|▋         | 197/2937 [00:43<08:13,  5.55it/s]














 10%|█         | 299/2937 [01:11<11:07,  3.95it/s]













 14%|█▎        | 397/2937 [01:37<08:14,  5.14it/s]













 17%|█▋        | 500/2937 [02:03<11:49,  3.43it/s]












 20%|██        | 596/2937 [02:27<06:15,  6.24it/s]












 24%|██▎       | 697/2937 [02:51<07:12,  5.18it/s]












 27%|██▋       | 803/2937 [03:15<06:33,  5.43it/s]













 31%|███       | 900/2937 [03:41<06:24,  5.30it/s]













 34%|███▍      | 1001/2937 [04:07<09:04,  3.55it/s]












 37%|███▋      | 1100/2937 [04:31<08:07,  3.77it/s]














 41%|████      | 1198/2937 [04:59<06:53,  4.20it/s]















 44%|████▍     | 1302/2937 [05:29<11:59,  2.27it/s]














 48%|████▊     | 1399/2937 [05:57<06:18,  4.06it/s]














 51%|█████     | 1503/2937 [06:25<05:37,  4.25it/s]













 54%|█████▍    | 1600/2937 [06:51<07:41,  2.90it/s]















 58%|█████▊    | 1698/2937 [07:22<05:10,  3.99it/s]
















 61%|██████▏   | 1804/2937 [07:54<03:00,  6.28it/s]














 65%|██████▍   | 1903/2937 [08:22<03:46,  4.57it/s]















 68%|██████▊   | 2004/2937 [08:52<04:22,  3.55it/s]
















 72%|███████▏  | 2100/2937 [09:24<05:06,  2.73it/s]




















 75%|███████▍  | 2200/2937 [10:04<05:27,  2.25it/s]


















 78%|███████▊  | 2300/2937 [10:40<03:14,  3.27it/s]















 82%|████████▏ | 2400/2937 [11:10<01:57,  4.57it/s]















 85%|████████▌ | 2500/2937 [11:40<01:53,  3.86it/s]














 89%|████████▊ | 2600/2937 [12:08<01:32,  3.65it/s]














 92%|█████████▏| 2695/2937 [12:36<01:25,  2.82it/s]














 95%|█████████▌| 2799/2937 [13:04<00:42,  3.24it/s]












 99%|█████████▊| 2899/2937 [13:28<00:07,  5.04it/s]




100%|██████████| 2937/2937 [13:37<00:00,  3.59it/s]














                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 157/157 [00:29<00:00,  5.40it/s]
 ========== finish to train server ==========
train the client 0 of communication round 0
client 0 0 / 411 inner epoch 0 round 0 / 50 loss 8.746322631835938 lr 1e-06
                   all       5000      36335      0.527      0.367      0.367        0.2
                   all       5000      36335      0.527      0.367      0.367        0.2
[34m[1mAMP: [39m[22mchecks passed ✅
[34m[1mAMP: [39m[22mchecks passed ✅













 26%|██▌       | 105/411 [00:27<00:59,  5.17it/s]














 49%|████▉     | 203/411 [00:55<00:48,  4.27it/s]















 73%|███████▎  | 301/411 [01:25<00:44,  2.45it/s]














 96%|█████████▋| 396/411 [01:53<00:04,  3.54it/s]

100%|██████████| 411/411 [01:56<00:00,  3.52it/s]













                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 157/157 [00:26<00:00,  5.96it/s]
train the client 1 of communication round 0
client 1 0 / 318 inner epoch 0 round 0 / 50 loss 10.082557678222656 lr 1e-06
                   all       5000      36335      0.548      0.353      0.367      0.207
                   all       5000      36335      0.548      0.353      0.367      0.207
[34m[1mAMP: [39m[22mchecks passed ✅
[34m[1mAMP: [39m[22mchecks passed ✅













 32%|███▏      | 101/318 [00:27<01:38,  2.21it/s]















 64%|██████▍   | 203/318 [00:56<00:30,  3.73it/s]

















 95%|█████████▍| 302/318 [01:31<00:04,  3.64it/s]


100%|██████████| 318/318 [01:35<00:00,  3.33it/s]













                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 157/157 [00:27<00:00,  5.69it/s]
---- calculate the model avg ----
                   all       5000      36335      0.565      0.324      0.341      0.192
                   all       5000      36335      0.565      0.324      0.341      0.192
                 Class     Images  Instances          P          R      mAP50   mAP50-95:   3%|▎         | 5/157 [00:00<00:25,  6.02it/s]












                 Class     Images  Instances          P          R      mAP50   mAP50-95: 100%|██████████| 157/157 [00:26<00:00,  6.01it/s]
                   all       5000      36335      0.584       0.38      0.401      0.228
                   all       5000      36335      0.584       0.38      0.401      0.228
  0%|          | 0/2937 [00:00<?, ?it/s]
---------- training server ----------
train the server of communication round 1










  3%|▎         | 102/2937 [00:20<07:20,  6.43it/s]











  7%|▋         | 195/2937 [00:41<12:24,  3.69it/s]















 10%|█         | 304/2937 [01:11<09:07,  4.80it/s]














 14%|█▍        | 404/2937 [01:39<11:32,  3.66it/s]













 17%|█▋        | 503/2937 [02:05<10:44,  3.78it/s]













 21%|██        | 603/2937 [02:31<08:13,  4.73it/s]











